#kivy 1.0.9

#<Widget>:
#    canvas.after:
#        Line:
#            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
#            dash_offset: 5
#            dash_length: 3

<GcodeCanvas>:
    canvas:
        Line:
            points: 0,self.offsetY,self.width,self.offsetY
            dash_offset: 5
        Line:
            points: self.offsetX,0,self.offsetX,self.height
            dash_offset: 5
        Line:
            circle: self.offsetX + root.crossPosX, self.offsetY + root.crossPosY, 15
        Line:
            points: self.offsetX + root.crossPosX - 15, self.offsetY + root.crossPosY - 15, self.offsetX + root.crossPosX + 15, self.offsetY + root.crossPosY + 15
        Line:
            points: self.offsetX + root.crossPosX + 15, self.offsetY + root.crossPosY - 15, self.offsetX + root.crossPosX - 15, self.offsetY + root.crossPosY + 15

<FrontPage>:
    textconsole:textconsole
    moveDistInput:moveDistInput
    moveSpeedInput:moveSpeedInput
    gcodecanvas:gcodecanvas
    
    GcodeCanvas:
        id: gcodecanvas
    GridLayout:
        cols: 4
        pos: self.width - 4*75, 0
        Button:
            text: '<^'
            size_hint: None, None
            width:75
            height: 60
            on_press: root.upLeft()
        Button:
            text: '^'
            size_hint: None, None
            width:75
            height: 60
            on_press: root.up()
        Button:
            text: '>^'
            size_hint: None, None
            width:75
            height: 60
            on_press: root.upRight()
        Button:
            text: 'UP'
            size_hint: None, None
            width:75
            height: 60
            on_press: root.zUp()
        Button:
            text: '<'
            size_hint: None, None
            width:75
            height: 60
            on_press: root.left()
        Button:
            text: 'HOME'
            size_hint: None, None
            width:75
            height: 60
            on_press: root.home()
        Button:
            text: '>'
            size_hint: None, None
            width:75
            height: 60
            on_press: root.right()
        Button:
            text: 'DOWN'
            size_hint: None, None
            width:75
            height: 60
            on_press: root.zDown()
        Button:
            text: '<\/'
            size_hint: None, None
            width:75
            height: 60
            on_press: root.downLeft()
        Button:
            text: '\/'
            size_hint: None, None
            width:75
            height: 60
            on_press: root.down()
        Button:
            text: '\/>'
            size_hint: None, None
            width:75
            height: 60
            on_press: root.downRight()
        Button:
            text: 'Stop'
            size_hint: None, None
            width:75
            height: 60
            on_press: root.stopRun()
        Button:
            text: 'Toggle\nSpindle'
            size_hint: None, None
            width:75
            height: 60
        Button:
            text: 'Re-Zero'
            size_hint: None, None
            width:75
            height: 60
        Button:
            text: 'Scroll\nEnable'
            size_hint: None, None
            width:75
            height: 60
        Button:
            text: 'RUN'
            size_hint: None, None
            width:75
            height: 60
    TextInput:
        id: moveDistInput
        text: "5"
        size_hint: None, None
        width: 225/2
        height: 40
        pos: root.width - 300, root.height-280
        multiline: False
        on_text: 
    TextInput:
        id: moveSpeedInput
        text: "200"
        size_hint: None, None
        width: 225/2
        height: 40
        pos: root.width - 188 , root.height-280
        multiline: False
    Button:
        text: 'mm'
        size_hint: None, None
        width:75
        height: 40
        pos: root.width - 75 , root.height-280
    Label:
        text: root.xReadoutPos
        size_hint: None, None
        pos: root.width - 220, root.height-360
    Label:
        text: root.yReadoutPos
        size_hint: None, None
        pos: root.width - 220, root.height-380
    Label:
        text: root.zReadoutPos
        size_hint: None, None
        pos: root.width - 220, root.height-400
    Label:
        text: "Estimated Time Remaining:"
        size_hint: None, None
        pos: root.width - 120, root.height-360
        font_size: '11sp'
    Label:
        text: "TBD"
        size_hint: None, None
        pos: root.width - 120, root.height-380
    Label:
        text: "0.0"
        size_hint: None, None
        pos: root.width - 120, root.height-400
    Label:
        text: "Connected on COM11"
        size_hint: None, None
        pos: root.width - 170, root.height-430
    Label:
        id: textconsole
        text: root.consoleText
        size_hint: None, None
        max_lines: 3
        pos: root.width - 170, root.height-500

<ViewMenu>:
    GridLayout:
        cols: 1
        size: root.size
        pos: root.pos
        Label:
            text: "View"
        Button:
            text: 'Open File'
        Button:
            text: 'Update Gcode'
        Button:
            text: 'View Gcode'
        Button:
            text: 'Reset Origin'
                
<RunMenu>:
    GridLayout:
        cols: 1
        size: root.size
        pos: root.pos
        Label:
            text: "Run"
        Button:
            text: 'Pause'
        Button:
            text: 'Resume'
        Button:
            text: 'Zero Z'
        Button:
            text: 'Auto Zero Z'
                
<ConnectMenu>:
    GridLayout:
        cols: 1
        size: root.size
        pos: root.pos
        Label:
            text: "Connect"
        Button:
            text: 'Reconnect'
            on_press: root.reconnect()
        Button:
            text: 'Ports'
            on_press: root.ports()
        Button:
            text: 'Update List'
                
<Diagnostics>:
    GridLayout:
        rows: 2
        size: root.size
        pos: root.pos
        Label:
            text: "Diagnostic features"
        GridLayout:
            cols: 3
            Button:
                text: 'Test Encoders'
            Button:
                text: 'Test Motors'
            Button:
                text: 'Test Both'
            Button:
                text: 'Calibrate Motors'
            Button:
                text: 'Calibrate Magnets'
            Button:
                text: 'About'

<ManualControl>:
    GridLayout:
        rows: 2
        size: root.size
        pos: root.pos
        Label:
            text: "Manual Control"
        GridLayout:
            cols: 12
            Label:
                text: "X:"
            Button:
                text: '-5'
            Button:
                text: '-4'
            Button:
                text: '-3'
            Button:
                text: '-2'
            Button:
                text: '-1'
            Button:
                text: '0'
            Button:
                text: '1'
            Button:
                text: '2'
            Button:
                text: '3'
            Button:
                text: '4'
            Button:
                text: '5'
            
            Label:
                text: "Y:"
            Button:
                text: '-5'
            Button:
                text: '-4'
            Button:
                text: '-3'
            Button:
                text: '-2'
            Button:
                text: '-1'
            Button:
                text: '0'
            Button:
                text: '1'
            Button:
                text: '2'
            Button:
                text: '3'
            Button:
                text: '4'
            Button:
                text: '5'
            
            Label:
                text: "Z:"
            Button:
                text: '-5'
            Button:
                text: '-4'
            Button:
                text: '-3'
            Button:
                text: '-2'
            Button:
                text: '-1'
            Button:
                text: '0'
            Button:
                text: '1'
            Button:
                text: '2'
            Button:
                text: '3'
            Button:
                text: '4'
            Button:
                text: '5'
                
<OtherFeatures>:
    connectmenu:connectmenu
    
    BoxLayout:
        orientation: 'vertical'
        BoxLayout:
            orientation: 'horizontal'
            padding:2
            spacing:0
            
            ViewMenu:
                id: viewmenu
            RunMenu:
                id: runmenu
            ConnectMenu:
                id: connectmenu
        BoxLayout:
            orientation: 'vertical'
            padding:2
            spacing:0
            
            Diagnostics:
                id: diagnostics
            ManualControl:
                id: manualcontrol

<SoftwareSettings>:
    GridLayout:
        cols: 1
        Button:
            text: 'Settings'
